# tcp与udp

TCP/IP具有两个具有代表性的传输层控制层协议tcp，udp

- tcp：传输控制协议（transmission control protocol）
- udp: 用户数据报协议（user datagram protocol）

IP首部有个协议字段用来标识网络层的上一层所采用的是哪一种传输控制协议

## TCP

TCP是面向连接的可靠的流协议，实行“顺序控制”或“重发控制”，“流量控制”，“拥塞控制”，提高网络利用率

**tcp如何保证可靠性？**

在tcp中发送端的数据到达接受主机时候，接受主机会返回一个收到的消息通知。这个消息叫做**确认应答**；
如果在一定时间内没有收到确认应答，发送端就认为是数据丢失，会进行重发。

- 但是存在一个问题？？

如果接收端已经收到了数据，只是返回**确认应答**的时候没能成功，使得发送端重复发送数据，这样接收端需要放弃重复的数据包，为此**序列号**就出现了。

序列号是按顺序给数据的每一个字节都标上号码的编号，接收端查询数据TCP首部序列号和数据长度，将自己下一步应该接受序列号作为确认应答返回去。

> MSS 最大消息长度，在建立tcp链接时，确定的发送数据包的单位，两端发出建立链接请求时，会在tcp首部写入MSS选项，告诉对方能接受MSS大小，然后在两端的mss中取较小的值投入使用。

**什么是窗口控制？**

Tcp每发一个段进行一次确认应答的处理，这种方式效率特别低，因此引入了“窗口控制”，
确认应答不再是以每个分段而是以更大的单位进行，（在发送一个段以后不必等待确认应答而是继续发送）
使用大量缓冲区，通过对多个段同时进行确认应答的功能，在发送端收到确认应答之前，必须在缓冲区保存所有
的数据。

***什么是流控制？**

当接收端处于高负荷的情况下会无法接受数据，造成发送端的数据无法被接受，触发重发机制，造成流量浪费。
因此tcp可以根据接收端的数据接收能力来控制发送的数据量。
（TCP首部中会有个专门的字段用来告诉发送端接收端的缓存区的大小）

**什么是拥塞控制？**

当网络出现拥堵时，如果突然发送一个较大的数据，可能会导致网络的瘫痪，为了防止这个问题，在通信的开始通过
一个叫做**慢启动**的算法对发送数据量进行控制；同时还定义了“拥塞窗口”。
首先拥塞窗口的大小设置为1MSS，之后每次收到一个确认应答（ACK），拥塞窗口的值就加1，
在发送数据时需要将拥塞窗口的大小与接收端的通知窗口（流量窗口）大小作比较，选择其小值来发送数据。

## UDP

udp是一种不可靠的数据传输协议，不能保证数据一定会到达目标节点，都是交给应用自行处理
udp常用于高速传输和实时性要求较高的通信或广播通信


通过[源，目标]ip地址，[源，目标]端口号，协议号进行通信识别

## 端口号如何确定

在进行通信时，要事先定义端口，端口号的确定有两种方法：

- 标准既定端口号

每个应用程序都有指定的端口号，每个端口号都有其使用目的
em: http 80 ，https 443 ， 

- 时序分配法

客户端完全不用设置端口号，而是全权交给操作系统分配














